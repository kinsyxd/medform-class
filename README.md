# Drug Form Classifier
Нейросеть для классификации форм выпуска лекарственных средств по изображениям.
Классы: capsules (капсулы), injections (инъекции), ointment (мази), suspension (суспензии), tablets (таблетки).

## Требования
- Python 3.10+
- TensorFlow 2.x

## Установка
1. Клонируйте репозиторий:
```bash
git clone https://github.com/kinsyxd/medform-class.git
cd cnn_project
```

2. Создайте виртуальное окружение:
```bash
python -m venv venv
```

3. Активируйте окружение:
```bash
# Windows
venv\Scripts\activate

# Linux/Mac
source venv/bin/activate
```

4. Установите зависимости:

```bash
pip install -r requirements.txt
```

## Использование

### Распознавание изображений
Поместите изображения в папку `test_images/` и запустите:

```bash
python predict.py
```

Скрипт выведет предсказанный класс и уверенность модели для каждого изображения.

### Обучение модели
Если нужно обучить модель заново:

1. Подготовьте датасет в папке `dataset/train/` с подпапками для каждого класса
2. Запустите обучение:

```bash
python train_model.py
```

Обучение занимает 10-30 минут в зависимости от оборудования.

### Оценка качества модели
Для детального анализа качества модели (матрица ошибок, метрики по классам):

```bash
python evaluate_model.py
```

## Структура проекта
```
cnn_project/
  predict.py              - распознавание изображений
  train_model.py          - обучение модели
  evaluate_model.py       - оценка качества
  drug_form_classifier.h5 - обученная модель
  class_names.txt         - названия классов
  requirements.txt        - зависимости
  dataset/train/          - данные для обучения
  test_images/            - изображения для тестирования
```

## Примечания
- Модель обучена на изображениях размером 384x384 пикселей
- Поддерживаемые форматы: JPG, JPEG, PNG
- Для лучших результатов используйте четкие изображения на однородном фоне